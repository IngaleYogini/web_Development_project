<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Gym Management</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
</head>

<body style="background-color:honeydew;">
    <div class="container-fluid">

        <div class="row">
            <div class="col-lg-12 bg-info">
                <h1 style="color:black"> RK FITNESS</h1>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-6 bg-warning">
                <table class="table">
                    <th><a href="adminhome.html">HOME</a></th>
                    <th><a href="show_plan.html">OUR PLANS</a></th>
                    <th><a href="reg.html">REGISTRATION</a></th>
                    <th><a href="show_equipment.html">EQUIPMENTS</a></th>
                    <th><a href="logout.html">LOGOUT</a></th>
                </table>
            </div>
            <div class="col-lg-6 bg-warning"></div>
        </div>

        <div class="row">
            <div class="col-lg-7">
                <div style="padding:20px">
                    <img src="image/newc.jpg" style="width:700px;">
                    <h4 style="padding:20px">Our Members...</h4>
                    <table class="table table-hover">
                    </table>
                </div>
            </div>

            <div class="col-lg-5">
                <div style="padding:20px">
                    <center><h4>--USER REGISTRATION FOR GYM--</h4></center>
                    
                    <!-- Fixed: Added id="gymForm" -->
                    <form id="gymForm">
                        <div class="form-group">
                            <label>NAME</label>
                            <input type="text" id="name" name="name" class="form-control" placeholder="Enter Name" required>
                        </div>

                        <div class="form-group">
                            <label>MOBILE</label>
                            <input type="text" id="mobile" name="mobile" class="form-control" placeholder="Enter Mobile" maxlength="10" pattern="[0-9]+" required>
                        </div>

                        <div class="form-group">
                            <label>Email</label>
                            <input type="text" id="email" name="email" class="form-control" placeholder="Enter Email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$" required>
                        </div>

                        <div class="form-group">
                            <label>AGE</label>
                            <input type="text" id="age" name="age" class="form-control" placeholder="Enter Age" maxlength="2" pattern="[0-9]+" required>
                        </div>

                        <div class="form-group">
                            <label>GENDER</label><br>
                            <label>Male <input type="radio" name="sex" value="male"></label>
                            <label>Female <input type="radio" name="sex" value="female"></label>
                        </div>

                        <div class="form-group">
                            <label>PLAN</label>
                            <select id="plan" name="plan" class="form-control">
                                <option value="">Select Plan</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>AMOUNT (In Rs.)</label>
                            <input type="text" id="amount" name="amount" class="form-control" placeholder="Enter Amount" required>
                        </div>

                        <div class="form-group">
                            <label>DURATION</label>
                            <select id="duration" name="duration" class="form-control">
                                <option value="">Select Duration</option>
                                <option>3 Month</option>
                                <option>6 Month</option>
                                <option>12 Month</option>
                            </select>
                        </div>

                        <input type="submit" value="Submit" class="form-control bg-success">
                    </form>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 bg-warning">
                <p align="center" style="color:black">Near Center Bank Of India</p>
                <p align="center" style="color:black">Vidyut Colony, Jalgaon, Maharashtra 425001</p>
            </div>
        </div>
    </div>

    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
        import { getDatabase, ref, get, push, set } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-database.js";    

        const firebaseConfig = {
            apiKey: "AIzaSyDQbdMR4PiKrqaWqh74TE6XkS1p4dgXO5g",
            authDomain: "gymmanagement-6a2d3.firebaseapp.com",
            databaseURL: "https://gymmanagement-6a2d3-default-rtdb.firebaseio.com/",
            projectId: "gymmanagement-6a2d3",
            storageBucket: "gymmanagement-6a2d3.appspot.com",
            messagingSenderId: "521194864869",
            appId: "1:521194864869:web:695eb2505c551f1ca8540c",
            measurementId: "G-GWRKK752ZX"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        function fetchPlans() {
            const planSelect = document.getElementById("plan");

            get(ref(db, "gym_plans")).then((snapshot) => {
                if (snapshot.exists()) {
                    planSelect.innerHTML = '<option value="">Select Plan</option>';
                    snapshot.forEach((childSnapshot) => {
                        let plan = childSnapshot.val();
                        let option = document.createElement("option");
                        option.value = plan.name;
                        option.textContent = `${plan.planName} - â‚¹${plan.amount}`;
                        planSelect.appendChild(option);
                    });
                } else {
                    console.log("No plans found.");
                }
            }).catch((error) => {
                console.error("Error fetching plans:", error);
            });
        }

        fetchPlans();

        document.getElementById("gymForm").addEventListener("submit", function(event) {
            event.preventDefault();

            let name = document.getElementById("name").value;
            let mobile = document.getElementById("mobile").value;
            let email = document.getElementById("email").value;
            let age = document.getElementById("age").value;
            let sex = document.querySelector('input[name="sex"]:checked')?.value;
            let plan = document.getElementById("plan").value;
            let amount = document.getElementById("amount").value;
            let duration = document.getElementById("duration").value;

            push(ref(db, "users"), { name, mobile, email, age, sex, plan, amount, duration })
            .then(() => {
                alert("Registration Successful!");
                document.getElementById("gymForm").reset();
            })
            .catch((error) => console.error("Error: ", error));
        });
    </script>
</body>
</html>
